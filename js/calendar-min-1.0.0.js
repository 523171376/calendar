var WC=function(){var t=this;return this.selecter,this.toolbar,this.monthContanier,this.contanier,this.root,this.data,this.dayClick,this.roomClick,this.currentTime,this.setSelecter=function(){t.selecter=arguments[0],t.toolbar=arguments[1],t.root=$("#"+arguments[0]),t.contanier=$("#"+arguments[0]).find(".body"),t.monthContanier=$("#"+arguments[1]).find(".month"),t.nextMonth=$("#"+arguments[3]),t.preMonth=$("#"+arguments[2])},this.setcall=function(){t.dayClick=arguments[0],t.roomClick=arguments[1]},this.render=function(a){var e=a||new Date,n=e.getFullYear(),i=e.getMonth()+1,o=[0,31,!(3&n||!(n%100))?29:28,31,30,31,30,31,31,30,31,30,31],r=o[i],d=o[1==i?12:i-1],c=new Date(n+"/"+i+"/1").getUTCDay()+1,l=t.buildHTML(r,d,c,n,i);t.contanier.html(l),t.monthContanier.html(n+"年"+i+"月"),t.monthContanier.data("month",n+"/"+i+"/1")},this.isWeekend=function(t){return 6===new Date(t).getUTCDay()+1||7===new Date(t).getUTCDay()+1},this.buildHTML=function(a,e,n,i,o){for(var r="",d=e-n+1,c=0,l=1,s=!1,h=1;h<=10;h++){r+='<div class="row"><table><tbody><tr>';for(var u=1;u<=7;u++){var m="day",y=i+"-"+o+"-"+l;t.isWeekend(i+"/"+o+"/"+l)&&(m="day weekend"),t.data[y]&&(m=("3"===t.data[y].type?"day holiday":"4"===t.data[y].type&&"day work")||m);var f="";t.data[y]&&(f=t.getDataHtml(y)),r+=1===h?u<n?'<td class="uncurrent" data-day="'+y+'"><i class="day">'+ ++d+"</i></td>":'<td class="current" data-day="'+y+'"><i class="'+m+'">'+l+"</i>"+f+"</td>":l>a?'<td class="uncurrent" data-day="'+y+'"><i class="day">'+ ++c+"</i></td>":'<td class="current" data-day="'+y+'"><i class="'+m+'">'+l+"</i>"+f+"</td>",l==a&&(s=!0),1===h&&u<n||l++}if(r+="</tr></tbody></table></div>",s)break}return r},this.startLoading=function(){for(var a='<div class="wc_loading"><span><ul>',e=0;e<15;e++)a+="<li></li>";a+="</ul><i>加载中...</i></span></div>",t.root.append(a),t.nextMonth.attr("disabled","true"),t.preMonth.attr("disabled","true")},this.endLoading=function(){t.root.find(".wc_loading").remove(),t.nextMonth.removeAttr("disabled"),t.preMonth.removeAttr("disabled")},this.bindFn=function(a,e){t.preMonth.click(function(){t.startLoading();var e=new Date(t.monthContanier.data("month"));e.setMonth(e.getMonth()-1),t.currentTime=e,a.call.call(a.call.this,e)}),t.nextMonth.click(function(){t.startLoading();var a=new Date(t.monthContanier.data("month"));a.setMonth(a.getMonth()+1),t.currentTime=a,e.call.call(e.call.this,a)}),this.contanier.on("click",".row table tbody tr td.current",function(a){$(".row table tbody tr td.current").removeClass("checked"),$(this).addClass("checked");var e=t.data[$(this).data("day")]||{};t.dayClick.call(t.dayClick.this,e),a.stopPropagation(),a.preventDefault()}),this.contanier.on("click",".row table tbody tr td .intd-content div span ul li",function(a){var e=t.data[$(this).parents("td").data("day")],n={};e&&(n=e.room[$(this).parents("span").data("index")].meetting[$(this).data("index")]),t.roomClick.call(t.roomClick.this,n),a.stopPropagation(),a.preventDefault()})},this.getYM=function(t){return t.getFullYear()+"-"+(t.getMonth()+1)},this.cacheData=function(a){var e={};$(a).each(function(t,a){e[a.day]=a}),t.data=e},this.getDataHtml=function(a){var e=t.data[a];if(!e.room)return"";var n='<div class="intd-content">',i="<div>",o="<div>",r=0;return $(e.room).each(function(a,e){"1"===e.type&&(r++,i+=t.getMeetHtml(e.meetting,r,a))}),$(e.room).each(function(a,e){"2"===e.type&&(r++,o+=t.getMeetHtml(e.meetting,r,a))}),n+=(i+="</div>")+(o+="</div>")+"</div>"},this.getMeetHtml=function(t,a,e){var n='<span data-index="'+e+'"><i class="bg-num">'+a+"</i><ul>",i=3===t.length?"more":"",o="",r="",d="";return $(t).each(function(t,a){var e="0"===a.booked?"free":"book-mine",n='<li class="'+i+" "+e+'" data-index="'+t+'"></li>';o="1"===a.type&&n||o,r="2"===a.type&&n||r,d="3"===a.type&&n||d}),n+=o+r+d,n+="</ul></span>"},{calender:{init:function(a){t.setSelecter(a.selecter,a.toolbar,a.preMonth.btn,a.nextMonth.btn),t.setcall(a.dayClick,a.roomClick),t.cacheData(a.currentData),t.render(),t.bindFn(a.preMonth,a.nextMonth)},load:function(a,e){t.cacheData(a),t.render(t.currentTime),t.endLoading()}}}}();